import mostFrequent

def computingFrequencies(Text,k):
    lst = [0]*((4**k))
    for i in range(len(Text)-k+1):
        lst[mostFrequent.patternToNumber(Text[i:i+k])] += 1
    
    return(lst)

def clumpFinding(Genome,k,L,t):
    words = []
    #compute frequencies for first L window
    freq = computingFrequencies(Genome[0:L],k)


    #check which kmers are forming L-t clumps for this window
    for i in range(len(freq)):
        if(freq[i] >= t):
            words.append(mostFrequent.numbertoPattern(i,k))
    
    #run through all other windows, adjusting the frequency array at the boundaries
    for i in range(1,len(Genome)-L+1):
        freq[mostFrequent.patternToNumber(Genome[i-1:i-1+k])] -= 1
        freq[mostFrequent.patternToNumber(Genome[i+L-k:i+L])] += 1

        if(freq[mostFrequent.patternToNumber(Genome[i+L-k:i+L])] >= t):
            words.append(Genome[i+L-k:i+L])

    
    words = list(dict.fromkeys(words))
    return(words)


st1 = "AGTACTCGGAGAACGTGCGATCAAGGAACCATCACATGTAGTAGCGGCAAGAGGATGTTGTTTTTAAAAACCAGCTGGTTCATTAAGCTCACGAACAGAGAACAACAGTTGGGACCGGGAAAGGAAAGTGAGCGTGCGCTTTTGGTGACAGGTCGTACTAGTAGGTGTCCAGATATCATGCCCAGGACGCGAAGTCCTCACTAGCACAGTGGATCGCCATCGGATTGACCCTATTCCCAACGTTCGATAAGTAATAAACAAATTGCCAATTCGGAACAGGCTAGAAGGTTAAGTTTCCAGTTCGACCGCGCTCTCTTTGATGGGGTTGCTGTCTTGCCTTGGAAACTTTTCTAGTGGCGCATTTGACTACATTGGCGCTGATAACAGGGGCTGACGACCGAAAGCTATCCGATTGCGTGACCATTGTGTTGGTGAACCAAGCCGAAGCTTTAAAGCGCTTCATGCCATATTCTGTGCTAAAAACACCAGCTATGGAGACTATGGAAATACTTGCTAGTTGGACTATATTTTGCGGTCAAAGGACACGTGAGACAGTGGACTGTTCGACGGAACTCGTCTATCGGCCTTCCTGCGCCTGCGGTTAATGATCGCGCCCCGCTCAATGCTGCTCGACTCTTTTTGGTCGTCGGCGTCTTCCGCGAGCGGACTGGCGCCGCGATTCCGTATCTGCTATTACCATCCAGCCGAATCTGCGAAGGAGGGAATGGTACAGTCTCTTGGTCTCCACACGCGGCTCCGCCTCAGTCGCATCGTCTGCGTCACGCGTTTAGATTGTCATGGCTATCGCAACCCGTTTCCTCGGTTAGAGGACAGGTCGAAGGGCTGGCGAAAGTGATGCCGCTGAAACAGCTACCATCAGCAACCCAGCAAGGAAGCTTGAATTGGCACTCGCACTGCCTGTTCCCTAAGCCGGCAAATGTATCCGTTGGGGCTGAGACTAGTGGTATCGGAAGGAAGGTTGGGTATCGCGCTAGGACTGGCCCCAGTTAACCGCTAATACGCCGTCAATTCCTACGCACGATTATCTTAACGGAATCCCGTTATCCGGGCTACGGTCCCTCCGATAGTGATCACGGCACAGCCCCTTGGCCCCGTCACGTCCCGACAAAGCAGATAAAGATCCGTTAACTGGTGACGTAGTCTGCGCCGTCTGCTTTCGATTCACTTCGGCCTAGCGGTCAGTAGCATACAGGTACCAGACAGGCACGTTGTCGTGTGCACGGGTTCTCACATTAGGGGGCACATCTATCGGACGACGAAACTTTACCTCATGCAACGGTTTGCTTGGTCGCGTAGCCTCAGTCCATACGTCCGTTCAACAAACCACCAGCTATCCATCAAACACATGGTGTATGCTGCTCTGTTGTAACCGCACCTGCTTATGTTCCGTGAAGACCCAGTCGTCAGGAGGGAAACTCAGGCCGAACCTAGTCAATCAGGCGAGGCCAGATATCCTTGCTCATTGCTAACCAACGGTGCTCAGTAGCAGGTGATCTAATATCCTACCGGTGCTTCGCTTGATCGCTCATATTGCTGCCGCTCGGGACAGGGAGCAGTACCCGGTGCCCTGAAGTGGGTCTACTATTCGCACGATTAACGGGGCATAGGGCCGAAGTTAGATACTCGTCTAAAGATCTGATGTACCCCAAGCCTGGGCGTGTAGTCCCGGCGGACTCTCGTCTGTGACGGCATGTGCCGTAGTGAGGTGATAAATCATCGTAGCCCTTACCTCCCCATGGCGTGCGGGGATTTGTGTTAGGTACGGTCTTTTCACGCGGGGATTTGTCATTAGCACTGCAGTATGCTACGTCGCGCCTTGTCGACACCTGCGTGTTACTCGAGCGGGGATTTGCTACTTGGGAGTGCAATGCGGGGATTTTGAATAACGAATCGGGGATTTATTTGGACCACCTATTATTGTAAGCGGGGATTTCACGCGGGGATTTCCGCGGGGATTTGATTATAACGAAATAATAACGAATCCCACTGCGACCACTTATAACGAATCGACATAACGAATCATAACGAATCGAGCTCATAACGAATCCTTGAACAATAACGAATCTTTAAGGCGATGTATAACGAATCTTATAACGAATCTAATAGACACGCGGGGATTTGTAATAACGAATATAACGAATCCAGCGGGGAATAACGAATCCCATAACGAATCACGAATCAGCGGGGATTTTAGCTGCGGCGGGGATTTGCGCCGAGAAACTTGCGCCGCGCGGGGATTTAGATAACATAACGAAATAACGAATCACGAATCCAGATAACGAATCCGCATAACGAATCCGAAGCGCGGGGATTTTACGCGGCGCGGGGATTTAACATAAATAACGAATCCTAAACCTTGCGCCGAATAAACGAGGTCGTGGACACTTGCGCCGATTCTTGCGCATAACGATAACGAATCCCTAGGACGAACAGCTTACGCCTTGATAACGAACAGCTACTTGCTTGCGCCGAACCTTTGTGTCGTGTGCTTACGAACAGCTCGCCGTGTTCTTGAACGAACAGCTCACGAACAGCTGCCGAGCTTGCGCCGAGTACGAACAGCTGAAGCGCACGAACAGCTAGCTGCTGACGGCTAAGGGGCTCCATACGAGCTAAGGGGCACGAACAGACGAACAGCTGCGCAGCTAGCTAAGGGGCTACGGTTCAGGCTAAGGGGCGAGAACGAACAGCTGCTAAGGGGCCTAAGGGGCCGCTAAGGGGCGCTAAGGGGCCGAACAGACGAACAGCGCTAAGGGGCACCAAAACGTATTAGGCTAAGGCTAAGGGGCCAGCTACGAACAGGCTAAGCTAAGGGGCGTCGGACACGAAACGAACAGCTGCTAAGGGGCCGCTAAGGGGCAGGCTAACAAGGAGTATATTACGAACAGCTCAAGGAGTATAGGAGTATATACGAACAGCTGTGGCAAGGAGTATTCCACGCTAAGGGGCGGGCGCTGGTCAACGAACAGCAAGGACAAGGAGTATTTCAACGAACAGCTGTGGAGCGCTAAGCTAACCACAAGGAGTATGGATCAAGGAGTATGCTAAGGGGCGGCCAGTGAGTGCCTTGACCCCCGCAAGGAGTATTGGCAGGCTAAGCAAGGAGTATCTAAGGGGCAACAAGGAGTATAGGAGCAAGGAGTATATGAGGCTAAGGGGCCAAGGAGTATTGGTCTCAAGGAGTATTAAACATCTTTACTATCCGGAGCTGCAAGGAGTATGGGAGCTGGTCAGCTGGTCCGGAGCTGGTCGACTCGGCTATCCCGCCGGGGCAAGGAGTATTGGTCAAGGAGTATCAAGGAGTATCGCGATAGCCAAGGAGTCAAGGAGTATTACTATCCCAAGGAGTATGCAAGGAGTATCGCCGCCAAGGAGTATAGGAGCTGGTCGGAGCTGGTCGAGCTGGTCCCGGGAGCTGGTCTGGAGCTGGTCTTTGTTGCATGGGGGAGCTGGTCGCGGGAGCTGGGGAGCTGGTCTCCCTACGGAGCTGGTCGGTCGCCGGTTATCCCGCCGATACTCAGTCACTATCCCGCCGTATCCCGCCGGATGTTAATTATTATCCCGCCGCTATCCCGCCGCTCCAATACATAGATATCCCGCCGGAACTAGCATAATATCCCGCCGGAAATTGTTTAGGCGGAAATATATCCCGCCGTCCCGCCGTGCATATCCCGTATCCCGCCGATGATATTTTGAGATTAGTGGCGCAAACTCCACTGCGGCCTTGACAGTCTCAAGAGGTGAATTCACTACTACTCGTGTGCGTTAAATGTAATCATCAACTAGTGTGATTCCCTCCTCGTGGAACCTGTAGCGTCCCCTTGACCCGTATTTTTCGCGGTACGCTACGCCATATTACCCACTACGACAGTCTTATTAATAGATAAGGAGAGGCACACAGGCACAGGGGCGCGTTACACAGGGGCGGGGTCCCATGGATATGCTTTTCACAGGGGCGCGGACCACGTATGAGAGTGTGCGGCGGAGCGATTTTCCCATGTAGTAAGATTTTACCCCACCCAAGACTAGTATGAGGTTTCCCCGTCACAGCACAGGGGCGAAGCACAGGGCACAGGGGCGCCACAGGGGCGGGCGTACACAGGGGCGCACAGGGGCGTAGCATCTTTTAGGCCGACAAACTCCACAGGGGCGGGGGGACAGGGCGCAGGACTTGGTGAGAGTCCAGCGGCAGCACAGGGGCGTCCGCGGACCGCAACCCGACCACAGGGCACAGGGGCGGGGCGCCCCTGGGCCGTCTACAAGGGACACAGGGGCGGCGGGCGAGCTCAGCCACCACAGGGGCGCGCATCGTGCACGGTAGATAGCCAGCACAGGGGCGTTATCCTTGAGAATGTGATGAGTGGACACAGGGGCGCTAAACCGCATCGCACAGGGGCGGGCGGAAATAGCCATATTAGCGGATCGCCAAGCATTACTTCTACACAGGGGCGCCACAGGGGCGCACACAGGGGCGCAAGTGCCACCGGCGTGACTAGCCACAATGGTCTGCGTTCCTATTATACCAAACCCCGTTTCCGGTGATCAGCTTGTTCTGGGTAACGCAGGCCGTCTGCAGCGTCATCAGGGCTGCAGGACGAGGAAAAATCGAAATGCTCACATTAGGTAAGGGTGGGAGGGCTGCGGTAATCTCCCAAGCGGTAGATGAATCTCAGGGTGGGAGAACGAGGGTGGGAGACAGGCCAGAGGGTGGGAGAGGACCTAGGGTGGGAGATCACTCAATATCCGCCCATATCCGCCCTAATATCCGCCCTATATATCCGCCCGGTGGGAGGGTGGGAGGATATCCGCCCGGGAGCAGTGAAGCGTTTTGGAGGGATATCCGCCCCCGTATCATTCCTCAGGTAGTAATATCCGCCCGGTGGGAGAATCAGGGTATATCCGCCCGGTTTAGATATCCGCCCGGGAGCCCGGACTCGAAGCACCGGATATCCGCCCTATAATCTGGATATCCGCATATCCGCCCGTGGGAGGGAGGGGAGAGGGTGAGGGTGGGAGTGTCCAGCTGCAGGGTGATATCCGCCCGGAGGGTGGGAGTCTAGGGTGATATCCGCCCCTGAACGCATCAGGGTGGATATCCGCCCTTGCCCGCATATCCGCCCGGTCGAACTACCGTCGCGATATCCGCCCATATCCGCCCTCGCGAGCGTCATATCCGCCCGGGTGGGAGACTGAATATCCGCCCGGTATATCCGCCCACTCCGTTAAAAGTTGGGACTTCTAGAGAGCTATCTAGATATCCGCCCCGCCCATCCGCCCAAGACCGATACAGGAATAATATCCGCCCCGGATATCATATCCGCCCGCGTGACATAGTCGCCTTTTCCCCAGAATTGGTCGAAATGTAAGATAACCGTTCACTTCCCGGCTCCCTTCTGCTATGGCAGTATCTGCAACTAAAAGCTCAGACAGAAGATCAAGAGTTGCCAATTAACCCAAATTTCTAACGGTAAGGTAAGAGCTGTGATATTCGTAGAATATAAAGGCGCGCACAGTGTTTCAGATAGTGTTGAGGCGCGATGTATACGTGGAGTCGAGCACTTTTGTACGGTTCACGGACAATACCGGACTAACGATTAAACTAGGTTTCCTGTCCTGCCGGAATAGGCAAGTATCGAGCAGAATGGACAGGGCGCTTAATGGACGGTGCAGTTGGAGACCTCGGAAGTTTAAACACCTTGGTGTGATGAGGCAAAGCATGCATGTGTCGACCACTTATATCATTTTCGTAAAAAGGAGGATAGAACGAATAGCGGGTCTATCGTATCGGAAAAGTTAGGGCCGCTTGTATTTATCGGAAAATCGATAAGTTATCGGAAAATCCCTATCGGAAAACGGAAAAACTAGGCTAATTCCGGTTATCGGAAAAGAGCTGTCCAAGTATTATCGGAAAACCTATCTATCGGAAAACCAACTGGATATCGGAAAAGACCTCCTGCGGAGTCATATCGGAAAAGAAGGTATCGGAAAAGAAAACATGAGGACAAACTGCGGTGGTCTGTCTGCTCGTGGCAAGAATATCGGAAAAGGGTATCGGAAAACCCAACCGTATCGGAAAATAAAATGGTATATCGGAAAAACGGAAAAACACCGTAGCATGTTTATCGGAAAAGAAACGAGAAGAGACCATCCAATATCGGAAAAAATGATACGCTTATCGGAAAACTCTATTGTTATCGGAAAACATGTATCGGAAAAAATCACTTGCTATCGGAAAACGTAAGTACGGGCGTTCCAACCCCTTTATCGGAAAAAAAAGCTTCAGAATGCCTATGGCGAGCTATCGGAATATCGGAAAAAGTAGGGATATCGTAGCAGAGCATGTTGAGGTGAGCCGTTGTCTAAAACAATTTCCTCTAGTGTGCCTACCTTCCACTGCATGCAACAGAATCTAGATCCCGTTCTCCAAGCTTGGAAAATCCTGAGGGTTAAGTAACACCAGGGTTCAGCCTGGCGTGTTTCATGAAGATTACCCTAAAGAATTGAGGACTATTCCGTCTACGTCCCGTCTACGTCCTACGTCCGATAACAAACCTTCCCCAATCCTCCGCTCCTATCACCCCGTGGGACGCCGTCTACGTCGTCTACGTCTACGTCTACGTCTCAGCCAATTCCGCCATTCCGTCTACGTCATAATGACTACGGAGGCAAGCTTCGTCTACGTCACGTATGCACAACGTCTACGTCTAACACTGTAAATGCGTCTACGTCGTGTACGTCTACGTCTATCGCCCGTCTACGTCGTAGCAACCGGCCCGTCTACGTCCGGAGGCGTCTACGTCGTTTGTCTATCAACATTAGTAGAGACGCGTCTACGTCCGGTAAGTACCTTCTGTACAAAACGTCGTCTACGTCTTCCTGTCGTCCGTCTACGTCCGCCGAATTGACAAACAGATAAGTCTCATGCCTATCCAATGACCTTTGAGAGGTTCGTCTACGTCCATGGCCGTCTACGCGTCTACGTCACGTCCTTCTTCGGCACTCGCGTCTACGTCCCGAGTTACGGGGACATCCACCAGATCCGTCTACGTCGTCTTCCGGACCAGTTGCAGACCCTCCTTCAGGGCCTGACGTCTACGTCTCTACGTCATCGTGGGGTTCCGAGTGCCCCCATAGACTTCAGCATGTATTCATGCGATTAAGTTTCCGCGTAACGAGGCGGCACTCAGAAAGCAACAGGGTATATGGGGTTTTCTGAGGGTACATAATCCTCGCAGAATACTAGCACCAAGATGCTTGGCATGCTAATTAGGATGATAACCCTGCCGGGCTGGACCGAGATTTTTAGAGTTTACATCGCTTCTCGCCGCGCCCCAAATTCGCCGGCTCGGCGCCCCCTGTCGGGAACAACTAAGACGTGGTGGATTCAGATCTTACCGTGATTCAAAGTGAAGCATAGGGGGCGAACCCTCAAGAGTATAGATTCCCCGTGCCAAGACTGACAATACAGCATTTTATTCCTCCGTGCGTAGACCCCCCTATTGCTGAGCCTGGCTTATACGGCACCCAGACACCGTCCGACTGCTGAATGCTGTTCTCTTCACTCATGGACCCGAGGCCGAGGCAGGAGTATAGTTGAATACTCGCTACTCTTCTATTTCCCTTCACTCCCGCCACCCGCGGTCAGACAGTACCTCGGCTTGTATTTTCAACAACTTCATGTAGGGTCGTTAGCTGGTGATACCGCTTAGAGATGTTTGATTGCATGACGTAGCAACATTATCACAACACCTGCCATACTAGGTTGATGACTCCATTATCGGATTTAAAATTAGGGTCACAGCTGTGAGTGGAGTAGTAGCCCCGGTGGGACGGCTCATGTCATACGAATGGCATGTTGGATCTACGGCACATGTACTTAGGAAATGCCCACCCTAACCACCCACTATTTGACCTCTCCCGACCCAGTATCTAGATACTTAAGGCCGCACCACCTAAGAAGACCGACGGTGTCCATGCTTCTGATGGGACTGTGTACCAACATCATCTTGGGCGGCCTGGAGACTGAAATGTACATGTTAAGGACGAGTAGTACGTCAAGACGGCGGTCAGGACGCATGGAATGCCCTAGAAGTGGTCCTGTGTCCCTGGCGTCCTATTAAAGGGAGTAATTAGGTCTCGAGCGGCTTATGTGGTCGCATGGACTGGTGCATGCGCTGCAACTACTGTTGGACTGGTGGTGGACTGGTGGTTCGTGGTTGGTCGTAGCTCGCAACCTCGGAAGACTCCTCTGGACTGGTGTCTATGTGGACTGGTGAACTAGCTTGCTTAGTTAGACCACGACGACTCCTGGACTGGTGAAGTGGACTGGTGGCGTTGGACTGGTGACCATGAAAATCATACTTAGCGCATACGCTTTGATCTTATCGCACCGGCATGTGGACTGGTGCAAGCTGGACTGGTGGAGCCTATGGACTGGTGGAACATACCCGCAACCGATCATAGGGGTTTAAGAGTAAATATGGACTGGTTGGACTGGTGGCGAGAGTCCGGCGTCGCTTACCAAACAACCTTATGGACTGGTGGGTGTAGTTGGACTGGTGTGGACTGGTGGTGGTGCCCGAGTGGACTGGTGTGCGCTCAGCCACTGGACTGGTGGTGGGGGACTGCTGGATGGACTGGTGTTCCAACATGTAATTGGCCTTCTATCACCCGGGCACAGCGCTCAACAACGTGTGGGCTTGCATCACGCAATGGACTGGTGTATTGGATGGACTGGTGCTGGTGACCTACACGTGGATAGGCGAGCGCAGGCGGAACTCTACCGTCATCGGCAACCGCCGATAACTTTCACTACGAGTGTTTTGGATGGGGACGCTCTCTTTCACTACGCGTACTAGACTTGTTGATCTTTCTTTCACTACTTTCACTACTGGCCCAATATTTCATTCTTTCACCTTTCACTACTTCACTACCTTACTTTCACTACCAGTGTATATTACTGGTATATGTTCGGCGGCCAAAAGTAAAACACCTATGATAGCTTTCACTACATGATGCCGAGATGTTCTTTCACTACGCTTCGCTCTTTCACTACAGCCCCTACTACCCTTTCACTACCAATCTTGTAATGGAATCTTTCACTACGTTCCTTTCACTACCTTTCACTACCACTACTGTTGGGCCAATCCCAATCTTGTCCACCAATCTTGTACCCCGCTGGAGATTGCCTTTCACTACTGCAGTCCCTGAGCACCTTTCACTACGCTTCATCTTTCACTACATCTTGTCCAATCTCTTTCACTACTGTCCCTTTCACTACAATCTTGTCCAATCTTCTTTCACTACGTCCAATCTTGTCCAATCTTGTCCAATCTTGTCCACTTTCACTTTCACTACTCCACTTTCACTACCTACTGTCCACCAATCTTGTCCAATCTTGTCCAATCTTGTCCAATCTTGTCCAATCTTGTCCAATCTTGT"
clump = clumpFinding(st1,10, 593, 16)
for i in clump:
    print(i)