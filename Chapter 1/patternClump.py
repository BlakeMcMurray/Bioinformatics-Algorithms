import mostFrequent

def computing_frequencies(text,k):
    lst = [0]*((4**k))
    for i in range(len(text)-k+1):
        lst[mostFrequent.pattern_to_number(text[i:i+k])] += 1
    
    return(lst)

def clump_finding(genome,k,L,t):
    words = []
    #compute frequencies for first L window
    freq = computing_frequencies(genome[0:L],k)


    #check which kmers are forming L-t clumps for this window
    for i in range(len(freq)):
        if(freq[i] >= t):
            words.append(mostFrequent.number_to_pattern(i,k))
    
    #run through all other windows, adjusting the frequency array at the boundaries
    for i in range(1,len(genome)-L+1):
        freq[mostFrequent.pattern_to_number(genome[i-1:i-1+k])] -= 1
        freq[mostFrequent.pattern_to_number(genome[i+L-k:i+L])] += 1

        if(freq[mostFrequent.pattern_to_number(genome[i+L-k:i+L])] >= t):
            words.append(genome[i+L-k:i+L])

    
    words = list(dict.fromkeys(words))
    return(words)


st_1 = "AGTACTCGGAGAACGTGCGATCAAGGAACCATCACATGTAGTAGCGGCAAGAGGATGTTGTTTTTAAAAACCAGCTGGTTCATTAAGCTCACGAACAGAGAACAACAGTTGGGACCGGGAAAGGAAAGTGAGCGTGCGCTTTTGGTGACAGGTCGTACTAGTAGGTGTCCAGATATCATGCCCAGGACGCGAAGTCCTCACTAGCACAGTGGATCGCCATCGGATTGACCCTATTCCCAACGTTCGATAAGTAATAAACAAATTGCCAATTCGGAACAGGCTAGAAGGTTAAGTTTCCAGTTCGACCGCGCTCTCTTTGATGGGGTTGCTGTCTTGCCTTGGAAACTTTTCTAGTGGCGCATTTGACTACATTGGCGCTGATAACAGGGGCTGACGACCGAAAGCTATCCGATTGCGTGACCATTGTGTTGGTGAACCAAGCCGAAGCTTTAAAGCGCTTCATGCCATATTCTGTGCTAAAAACACCAGCTATGGAGACTATGGAAATACTTGCTAGTTGGACTATATTTTGCGGTCAAAGGACACGTGAGACAGTGGACTGTTCGACGGAACTCGTCTATCGGCCTTCCTGCGCCTGCGGTTAATGATCGCGCCCCGCTCAATGCTGCTCGACTCTTTTTGGTCGTCGGCGTCTTCCGCGAGCGGACTGGCGCCGCGATTCCGTATCTGCTATTACCATCCAGCCGAATCTGCGAAGGAGGGAATGGTACAGTCTCTTGGTCTCCACACGCGGCTCCGCCTCAGTCGCATCGTCTGCGTCACGCGTTTAGATTGTCATGGCTATCGCAACCCGTTTCCTCGGTTAGAGGACAGGTCGAAGGGCTGGCGAAAGTGATGCCGCTGAAACAGCTACCATCAGCAACCCAGCAAGGAAGCTTGAATTGGCACTCGCACTGCCTGTTCCCTAAGCCGGCAAATGTATCCGTTGGGGCTGAGACTAGTGGTATCGGAAGGAAGGTTGGGTATCGCGCTAGGACTGGCCCCAGTTAACCGCTAATACGCCGTCAATTCCTACGCACGATTATCTTAACGGAATCCCGTTATCCGGGCTACGGTCCCTCCGATAGTGATCACGGCACAGCCCCTTGGCCCCGTCACGTCCCGACAAAGCAGATAAAGATCCGTTAACTGGTGACGTAGTCTGCGCCGTCTGCTTTCGATTCACTTCGGCCTAGCGGTCAGTAGCATACAGGTACCAGACAGGCACGTTGTCGTGTGCACGGGTTCTCACATTAGGGGGCACATCTATCGGACGACGAAACTTTACCTCATGCAACGGTTTGCTTGGTCGCGTAGCCTCAGTCCATACGTCCGTTCAACAAACCACCAGCTATCCATCAAACACATGGTGTATGCTGCTCTGTTGTAACCGCACCTGCTTATGTTCCGTGAAGACCCAGTCGTCAGGAGGGAAACTCAGGCCGAACCTAGTCAATCAGGCGAGGCCAGATATCCTTGCTCATTGCTAACCAACGGTGCTCAGTAGCAGGTGATCTAATATCCTACCGGTGCTTCGCTTGATCGCTCATATTGCTGCCGCTCGGGACAGGGAGCAGTACCCGGTGCCCTGAAGTGGGTCTACTATTCGCACGATTAACGGGGCATAGGGCCGAAGTTAGATACTCGTCTAAAGATCTGATGTACCCCAAGCCTGGGCGTGTAGTCCCGGCGGACTCTCGTCTGTGACGGCATGTGCCGTAGTGAGGTGATAAATCATCGTAGCCCTTACCTCCCCATGGCGTGCGGGGATTTGTGTTAGGTACGGTCTTTTCACGCGGGGATTTGTCATTAGCACTGCAGTATGCTACGTCGCGCCTTGTCGACACCTGCGTGTTACTCGAGCGGGGATTTGCTACTTGGGAGTGCAATGCGGGGATTTTGAATAACGAATCGGGGATTTATTTGGACCACCTATTATTGTAAGCGGGGATTTCACGCGGGGATTTCCGCGGGGATTTGATTATAACGAAATAATAACGAATCCCACTGCGACCACTTATAACGAATCGACATAACGAATCATAACGAATCGAGCTCATAACGAATCCTTGAACAATAACGAATCTTTAAGGCGATGTATAACGAATCTTATAACGAATCTAATAGACACGCGGGGATTTGTAATAACGAATATAACGAATCCAGCGGGGAATAACGAATCCCATAACGAATCACGAATCAGCGGGGATTTTAGCTGCGGCGGGGATTTGCGCCGAGAAACTTGCGCCGCGCGGGGATTTAGATAACATAACGAAATAACGAATCACGAATCCAGATAACGAATCCGCATAACGAATCCGAAGCGCGGGGATTTTACGCGGCGCGGGGATTTAACATAAATAACGAATCCTAAACCTTGCGCCGAATAAACGAGGTCGTGGACACTTGCGCCGATTCTTGCGCATAACGATAACGAATCCCTAGGACGAACAGCTTACGCCTTGATAACGAACAGCTACTTGCTTGCGCCGAACCTTTGTGTCGTGTGCTTACGAACAGCTCGCCGTGTTCTTGAACGAACAGCTCACGAACAGCTGCCGAGCTTGCGCCGAGTACGAACAGCTGAAGCGCACGAACAGCTAGCTGCTGACGGCTAAGGGGCTCCATACGAGCTAAGGGGCACGAACAGACGAACAGCTGCGCAGCTAGCTAAGGGGCTACGGTTCAGGCTAAGGGGCGAGAACGAACAGCTGCTAAGGGGCCTAAGGGGCCGCTAAGGGGCGCTAAGGGGCCGAACAGACGAACAGCGCTAAGGGGCACCAAAACGTATTAGGCTAAGGCTAAGGGGCCAGCTACGAACAGGCTAAGCTAAGGGGCGTCGGACACGAAACGAACAGCTGCTAAGGGGCCGCTAAGGGGCAGGCTAACAAGGAGTATATTACGAACAGCTCAAGGAGTATAGGAGTATATACGAACAGCTGTGGCAAGGAGTATTCCACGCTAAGGGGCGGGCGCTGGTCAACGAACAGCAAGGACAAGGAGTATTTCAACGAACAGCTGTGGAGCGCTAAGCTAACCACAAGGAGTATGGATCAAGGAGTATGCTAAGGGGCGGCCAGTGAGTGCCTTGACCCCCGCAAGGAGTATTGGCAGGCTAAGCAAGGAGTATCTAAGGGGCAACAAGGAGTATAGGAGCAAGGAGTATATGAGGCTAAGGGGCCAAGGAGTATTGGTCTCAAGGAGTATTAAACATCTTTACTATCCGGAGCTGCAAGGAGTATGGGAGCTGGTCAGCTGGTCCGGAGCTGGTCGACTCGGCTATCCCGCCGGGGCAAGGAGTATTGGTCAAGGAGTATCAAGGAGTATCGCGATAGCCAAGGAGTCAAGGAGTATTACTATCCCAAGGAGTATGCAAGGAGTATCGCCGCCAAGGAGTATAGGAGCTGGTCGGAGCTGGTCGAGCTGGTCCCGGGAGCTGGTCTGGAGCTGGTCTTTGTTGCATGGGGGAGCTGGTCGCGGGAGCTGGGGAGCTGGTCTCCCTACGGAGCTGGTCGGTCGCCGGTTATCCCGCCGATACTCAGTCACTATCCCGCCGTATCCCGCCGGATGTTAATTATTATCCCGCCGCTATCCCGCCGCTCCAATACATAGATATCCCGCCGGAACTAGCATAATATCCCGCCGGAAATTGTTTAGGCGGAAATATATCCCGCCGTCCCGCCGTGCATATCCCGTATCCCGCCGATGATATTTTGAGATTAGTGGCGCAAACTCCACTGCGGCCTTGACAGTCTCAAGAGGTGAATTCACTACTACTCGTGTGCGTTAAATGTAATCATCAACTAGTGTGATTCCCTCCTCGTGGAACCTGTAGCGTCCCCTTGACCCGTATTTTTCGCGGTACGCTACGCCATATTACCCACTACGACAGTCTTATTAATAGATAAGGAGAGGCACACAGGCACAGGGGCGCGTTACACAGGGGCGGGGTCCCATGGATATGCTTTTCACAGGGGCGCGGACCACGTATGAGAGTGTGCGGCGGAGCGATTTTCCCATGTAGTAAGATTTTACCCCACCCAAGACTAGTATGAGGTTTCCCCGTCACAGCACAGGGGCGAAGCACAGGGCACAGGGGCGCCACAGGGGCGGGCGTACACAGGGGCGCACAGGGGCGTAGCATCTTTTAGGCCGACAAACTCCACAGGGGCGGGGGGACAGGGCGCAGGACTTGGTGAGAGTCCAGCGGCAGCACAGGGGCGTCCGCGGACCGCAACCCGACCACAGGGCACAGGGGCGGGGCGCCCCTGGGCCGTCTACAAGGGACACAGGGGCGGCGGGCGAGCTCAGCCACCACAGGGGCGCGCATCGTGCACGGTAGATAGCCAGCACAGGGGCGTTATCCTTGAGAATGTGATGAGTGGACACAGGGGCGCTAAACCGCATCGCACAGGGGCGGGCGGAAATAGCCATATTAGCGGATCGCCAAGCATTACTTCTACACAGGGGCGCCACAGGGGCGCACACAGGGGCGCAAGTGCCACCGGCGTGACTAGCCACAATGGTCTGCGTTCCTATTATACCAAACCCCGTTTCCGGTGATCAGCTTGTTCTGGGTAACGCAGGCCGTCTGCAGCGTCATCAGGGCTGCAGGACGAGGAAAAATCGAAATGCTCACATTAGGTAAGGGTGGGAGGGCTGCGGTAATCTCCCAAGCGGTAGATGAATCTCAGGGTGGGAGAACGAGGGTGGGAGACAGGCCAGAGGGTGGGAGAGGACCTAGGGTGGGAGATCACTCAATATCCGCCCATATCCGCCCTAATATCCGCCCTATATATCCGCCCGGTGGGAGGGTGGGAGGATATCCGCCCGGGAGCAGTGAAGCGTTTTGGAGGGATATCCGCCCCCGTATCATTCCTCAGGTAGTAATATCCGCCCGGTGGGAGAATCAGGGTATATCCGCCCGGTTTAGATATCCGCCCGGGAGCCCGGACTCGAAGCACCGGATATCCGCCCTATAATCTGGATATCCGCATATCCGCCCGTGGGAGGGAGGGGAGAGGGTGAGGGTGGGAGTGTCCAGCTGCAGGGTGATATCCGCCCGGAGGGTGGGAGTCTAGGGTGATATCCGCCCCTGAACGCATCAGGGTGGATATCCGCCCTTGCCCGCATATCCGCCCGGTCGAACTACCGTCGCGATATCCGCCCATATCCGCCCTCGCGAGCGTCATATCCGCCCGGGTGGGAGACTGAATATCCGCCCGGTATATCCGCCCACTCCGTTAAAAGTTGGGACTTCTAGAGAGCTATCTAGATATCCGCCCCGCCCATCCGCCCAAGACCGATACAGGAATAATATCCGCCCCGGATATCATATCCGCCCGCGTGACATAGTCGCCTTTTCCCCAGAATTGGTCGAAATGTAAGATAACCGTTCACTTCCCGGCTCCCTTCTGCTATGGCAGTATCTGCAACTAAAAGCTCAGACAGAAGATCAAGAGTTGCCAATTAACCCAAATTTCTAACGGTAAGGTAAGAGCTGTGATATTCGTAGAATATAAAGGCGCGCACAGTGTTTCAGATAGTGTTGAGGCGCGATGTATACGTGGAGTCGAGCACTTTTGTACGGTTCACGGACAATACCGGACTAACGATTAAACTAGGTTTCCTGTCCTGCCGGAATAGGCAAGTATCGAGCAGAATGGACAGGGCGCTTAATGGACGGTGCAGTTGGAGACCTCGGAAGTTTAAACACCTTGGTGTGATGAGGCAAAGCATGCATGTGTCGACCACTTATATCATTTTCGTAAAAAGGAGGATAGAACGAATAGCGGGTCTATCGTATCGGAAAAGTTAGGGCCGCTTGTATTTATCGGAAAATCGATAAGTTATCGGAAAATCCCTATCGGAAAACGGAAAAACTAGGCTAATTCCGGTTATCGGAAAAGAGCTGTCCAAGTATTATCGGAAAACCTATCTATCGGAAAACCAACTGGATATCGGAAAAGACCTCCTGCGGAGTCATATCGGAAAAGAAGGTATCGGAAAAGAAAACATGAGGACAAACTGCGGTGGTCTGTCTGCTCGTGGCAAGAATATCGGAAAAGGGTATCGGAAAACCCAACCGTATCGGAAAATAAAATGGTATATCGGAAAAACGGAAAAACACCGTAGCATGTTTATCGGAAAAGAAACGAGAAGAGACCATCCAATATCGGAAAAAATGATACGCTTATCGGAAAACTCTATTGTTATCGGAAAACATGTATCGGAAAAAATCACTTGCTATCGGAAAACGTAAGTACGGGCGTTCCAACCCCTTTATCGGAAAAAAAAGCTTCAGAATGCCTATGGCGAGCTATCGGAATATCGGAAAAAGTAGGGATATCGTAGCAGAGCATGTTGAGGTGAGCCGTTGTCTAAAACAATTTCCTCTAGTGTGCCTACCTTCCACTGCATGCAACAGAATCTAGATCCCGTTCTCCAAGCTTGGAAAATCCTGAGGGTTAAGTAACACCAGGGTTCAGCCTGGCGTGTTTCATGAAGATTACCCTAAAGAATTGAGGACTATTCCGTCTACGTCCCGTCTACGTCCTACGTCCGATAACAAACCTTCCCCAATCCTCCGCTCCTATCACCCCGTGGGACGCCGTCTACGTCGTCTACGTCTACGTCTACGTCTCAGCCAATTCCGCCATTCCGTCTACGTCATAATGACTACGGAGGCAAGCTTCGTCTACGTCACGTATGCACAACGTCTACGTCTAACACTGTAAATGCGTCTACGTCGTGTACGTCTACGTCTATCGCCCGTCTACGTCGTAGCAACCGGCCCGTCTACGTCCGGAGGCGTCTACGTCGTTTGTCTATCAACATTAGTAGAGACGCGTCTACGTCCGGTAAGTACCTTCTGTACAAAACGTCGTCTACGTCTTCCTGTCGTCCGTCTACGTCCGCCGAATTGACAAACAGATAAGTCTCATGCCTATCCAATGACCTTTGAGAGGTTCGTCTACGTCCATGGCCGTCTACGCGTCTACGTCACGTCCTTCTTCGGCACTCGCGTCTACGTCCCGAGTTACGGGGACATCCACCAGATCCGTCTACGTCGTCTTCCGGACCAGTTGCAGACCCTCCTTCAGGGCCTGACGTCTACGTCTCTACGTCATCGTGGGGTTCCGAGTGCCCCCATAGACTTCAGCATGTATTCATGCGATTAAGTTTCCGCGTAACGAGGCGGCACTCAGAAAGCAACAGGGTATATGGGGTTTTCTGAGGGTACATAATCCTCGCAGAATACTAGCACCAAGATGCTTGGCATGCTAATTAGGATGATAACCCTGCCGGGCTGGACCGAGATTTTTAGAGTTTACATCGCTTCTCGCCGCGCCCCAAATTCGCCGGCTCGGCGCCCCCTGTCGGGAACAACTAAGACGTGGTGGATTCAGATCTTACCGTGATTCAAAGTGAAGCATAGGGGGCGAACCCTCAAGAGTATAGATTCCCCGTGCCAAGACTGACAATACAGCATTTTATTCCTCCGTGCGTAGACCCCCCTATTGCTGAGCCTGGCTTATACGGCACCCAGACACCGTCCGACTGCTGAATGCTGTTCTCTTCACTCATGGACCCGAGGCCGAGGCAGGAGTATAGTTGAATACTCGCTACTCTTCTATTTCCCTTCACTCCCGCCACCCGCGGTCAGACAGTACCTCGGCTTGTATTTTCAACAACTTCATGTAGGGTCGTTAGCTGGTGATACCGCTTAGAGATGTTTGATTGCATGACGTAGCAACATTATCACAACACCTGCCATACTAGGTTGATGACTCCATTATCGGATTTAAAATTAGGGTCACAGCTGTGAGTGGAGTAGTAGCCCCGGTGGGACGGCTCATGTCATACGAATGGCATGTTGGATCTACGGCACATGTACTTAGGAAATGCCCACCCTAACCACCCACTATTTGACCTCTCCCGACCCAGTATCTAGATACTTAAGGCCGCACCACCTAAGAAGACCGACGGTGTCCATGCTTCTGATGGGACTGTGTACCAACATCATCTTGGGCGGCCTGGAGACTGAAATGTACATGTTAAGGACGAGTAGTACGTCAAGACGGCGGTCAGGACGCATGGAATGCCCTAGAAGTGGTCCTGTGTCCCTGGCGTCCTATTAAAGGGAGTAATTAGGTCTCGAGCGGCTTATGTGGTCGCATGGACTGGTGCATGCGCTGCAACTACTGTTGGACTGGTGGTGGACTGGTGGTTCGTGGTTGGTCGTAGCTCGCAACCTCGGAAGACTCCTCTGGACTGGTGTCTATGTGGACTGGTGAACTAGCTTGCTTAGTTAGACCACGACGACTCCTGGACTGGTGAAGTGGACTGGTGGCGTTGGACTGGTGACCATGAAAATCATACTTAGCGCATACGCTTTGATCTTATCGCACCGGCATGTGGACTGGTGCAAGCTGGACTGGTGGAGCCTATGGACTGGTGGAACATACCCGCAACCGATCATAGGGGTTTAAGAGTAAATATGGACTGGTTGGACTGGTGGCGAGAGTCCGGCGTCGCTTACCAAACAACCTTATGGACTGGTGGGTGTAGTTGGACTGGTGTGGACTGGTGGTGGTGCCCGAGTGGACTGGTGTGCGCTCAGCCACTGGACTGGTGGTGGGGGACTGCTGGATGGACTGGTGTTCCAACATGTAATTGGCCTTCTATCACCCGGGCACAGCGCTCAACAACGTGTGGGCTTGCATCACGCAATGGACTGGTGTATTGGATGGACTGGTGCTGGTGACCTACACGTGGATAGGCGAGCGCAGGCGGAACTCTACCGTCATCGGCAACCGCCGATAACTTTCACTACGAGTGTTTTGGATGGGGACGCTCTCTTTCACTACGCGTACTAGACTTGTTGATCTTTCTTTCACTACTTTCACTACTGGCCCAATATTTCATTCTTTCACCTTTCACTACTTCACTACCTTACTTTCACTACCAGTGTATATTACTGGTATATGTTCGGCGGCCAAAAGTAAAACACCTATGATAGCTTTCACTACATGATGCCGAGATGTTCTTTCACTACGCTTCGCTCTTTCACTACAGCCCCTACTACCCTTTCACTACCAATCTTGTAATGGAATCTTTCACTACGTTCCTTTCACTACCTTTCACTACCACTACTGTTGGGCCAATCCCAATCTTGTCCACCAATCTTGTACCCCGCTGGAGATTGCCTTTCACTACTGCAGTCCCTGAGCACCTTTCACTACGCTTCATCTTTCACTACATCTTGTCCAATCTCTTTCACTACTGTCCCTTTCACTACAATCTTGTCCAATCTTCTTTCACTACGTCCAATCTTGTCCAATCTTGTCCAATCTTGTCCACTTTCACTTTCACTACTCCACTTTCACTACCTACTGTCCACCAATCTTGTCCAATCTTGTCCAATCTTGTCCAATCTTGTCCAATCTTGTCCAATCTTGT"
clump = clump_finding(st_1,10, 593, 16)
for i in clump:
    print(i)
